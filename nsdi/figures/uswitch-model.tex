\documentclass[a4paper,18pt]{article}

\usepackage[english]{babel}
\usepackage[T1]{fontenc}
\usepackage[ansinew]{inputenc}
\usepackage{libertine}
\usepackage[italic]{mathastext}
\usepackage{amsmath,amsthm,amsfonts}
\usepackage{xcolor}
\usepackage{tikz}
\usepackage{subcaption}

\usetikzlibrary{shapes,arrows,shadows}
\usetikzlibrary{arrows.meta}
\usetikzlibrary{shapes.geometric}
\usetikzlibrary{automata,positioning,arrows,matrix,backgrounds,calc}
\usetikzlibrary{decorations.text}
\usetikzlibrary{decorations.pathmorphing}

\usepackage[active,tightpage]{preview}
\usepackage{xparse}
\PreviewEnvironment{tikzpicture}
\setlength\PreviewBorder{0pt}%

\usetikzlibrary{fit}					% fitting shapes to coordinates
\usetikzlibrary{backgrounds}	% drawing the background after the foreground
\usetikzlibrary{calc}

\renewcommand*{\familydefault}{\sfdefault}% Let's have a sans serif font

\begin{document}
\tikzset{
    queuei/.pic={
  \stepcounter{cntr}
        \node[outer sep=0pt,draw,rectangle split,rectangle split horizontal,minimum height=2em,rectangle split parts=3] (queue-\thecntr) [pic actions] {};
        \draw 
          (queue-\thecntr.north west) -- ++(-1cm,0)
          (queue-\thecntr.south west) -- ++(-1cm,0);
        \node[above] at ([xshift=-0.5cm]queue-\thecntr.north) {#1 buffer};
    },
}



\tikzstyle{block}=[rectangle, draw, fill=white!10, minimum height=6ex,text width=4em, text centered, inner sep=1pt]
\tikzstyle{textbox}=[text width=2em, text centered, text width=3em]
  \tikzstyle{line}=[draw, very thick, color=black!75, -latex']
  \tikzstyle{empty}=[]

\newcounter{cntr}
\begin{tikzpicture}[>=latex]
% the shapes
\path
(0,0) pic[rectangle split part fill={white,white,gray!80},anchor=east] {queuei=Input}
(7,0) pic[anchor=west] {queuei=Output};
\node (program) at (1,0) [rectangle, draw, minimum height=1cm, text centered, text width=10em,anchor=west] {\large $\mu$-program body};
\path [line] (0,0) -- (1,0);
\path [line] ($(program.east)+(0,0.4)$) -- (6,0.4);
\path [line] ($(program.east)+(0,0.2)$) -- (6,0.2);
\path [line] ($(program.east)+(0,-0.4)$) -- (6,-0.4);
\path [line, dotted] (1,0.75) -- (0.25,0.5);
\path [line, dotted] (5,0.75) -- (5.75,0.5);
\path [line, -, dotted] (5,-0.27) -- (5,0.2);

\node () at ($(program.north)+(0.5,0.5)$) {{packet byte-stream, metadata, arguments}};
\end{tikzpicture}
\end{document}
